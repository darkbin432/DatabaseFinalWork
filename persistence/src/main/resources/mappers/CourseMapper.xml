<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xhtlwb.dbfinal.persistence.CourseDao">

<!--    <insert id="insertInfo" parameterType="com.xhtlwb.dbfinal.model.Course" useGeneratedKeys="true" keyProperty="id">-->
<!--        INSERT INTO course(title, description, teacher_id, created_time, updated_time, status)-->
<!--        VALUES (#{title}, #{description}, #{teacherId}, now(), now(), #{status});-->
<!--    </insert>-->

    <update id="updateInfo" parameterType="com.xhtlwb.dbfinal.model.Course">
        UPDATE course
        SET
        <if test="title!=null">
            title = #{title},
        </if>
        <if test="description!=null">
            description = #{description},
        </if>
        <if test="teacherId!=null">
            teacher_id = #{teacherId},
        </if>
        <if test="createdTime!=null">
            created_time = #{createdTime},
        </if>
        <if test="updatedTime!=null">
            updated_time = #{updatedTime}
        </if>
        updated_time = now()
        where id = #{id};
    </update>

    <update id="deleteInfo" parameterType="int">
        UPDATE course
        SET status = 0
        WHERE id = #{id}
    </update>

    <select id="getOne" parameterType="int" resultType="com.xhtlwb.dbfinal.model.Course">
        SELECT *
        FROM course
        WHERE id = #{id} AND status = 1
        LIMIT 1;
    </select>

    <select id="getAllCourse" parameterType="com.xhtlwb.dbfinal.model.Course" resultType="com.xhtlwb.dbfinal.model.Course">
        SELECT *
        FROM course
        <where>
            status = 1
            <if test="title!=null">
                AND title LIKE "%"#{title}
            </if>
            <if test="teacherId!=null">
                AND teacher_id = #{teacherId}
            </if>
        </where>
        ORDER BY id DESC
        <if test="offset!=null and size!=null">
            LIMIT #{offset},#{size};
        </if>
    </select>

</mapper>